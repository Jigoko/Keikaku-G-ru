local library = loadstring(game:HttpGet(('https://raw.githubusercontent.com/AikaV3rm/UiLib/master/Lib.lua')))()

local w = library:CreateWindow("Project Ghoul")

local b = w:CreateFolder("Auto Farm")

local d = w:CreateFolder("Extra")

local userInputService = game:service('UserInputService')
local VIM = game:GetService("VirtualInputManager")
local players = game:GetService("Players")
local VirtualUser = game:service'VirtualUser'
local plr = players.LocalPlayer
local Char = plr.Character or plr.CharacterAdded:wait()
local Speed = 150
local minlvl = 1
local maxlvl = 100
local distance = 5
local ScriptOn = false
local stopscript = false
local eat = false
local z = false
local x = false
local c = false
b:Slider("Npc Minimum Level",{
    min = 1; -- min value of the slider
    max = 930; -- max value of the slider
    precise = false; -- max 2 decimals
},function(value)
    minlvl = value
end)
b:Slider("Npc Maxiumum Level",{
    min = 1; -- min value of the slider
    max = 930; -- max value of the slider
    precise = false; -- max 2 decimals
},function(value)
    maxlvl = value
end)
b:Slider("Distance from Npc",{
    min = 3; -- min value of the slider
    max = 14; -- max value of the slider
    precise = true; -- max 2 decimals
},function(value)
    distance = value
end)
b:Toggle("Use Z Skill",function(bool)
    z = bool
end)
b:Toggle("Use X Skill",function(bool)
    x = bool
end)
b:Toggle("Use C Skill",function(bool)
    c = bool
end)
b:Bind("Auto Farm Key",Enum.KeyCode.U,function()
    if chat then return end
    if ScriptOn then
        ScriptOn = false
    elseif not ScriptOn then
        ScriptOn = true
    end
end)
plr.Idled:connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)
function findplayers()
    for i,v in pairs(players:GetChildren()) do
        if v.Name ~= players.LocalPlayer.Name then
            return true
        end
    end
    return false
end
d:Toggle("Stop AutoFarm if a player joins your server",function(bool)
    stopscript = bool
    if stopscript then
        coroutine.wrap(function()
            while task.wait(5) do
                pcall(function()
                    if findplayers() then
                        ScriptOn = false
                    else
                        ScriptOn = true
                    end
                end)
                if stopscript == false then break end
            end
        end)()
    end
end)
d:Toggle("Eat bodies",function(bool)
    eat = bool
end)
function FoundTarget()
    local Target = {}
    local HRP = plr.Character.HumanoidRootPart
    for _,v in pairs(game:GetService("Workspace").NPCs.Alive:GetChildren()) do
        if v:IsA("Model") and v:FindFirstChild("defaultSpawn")  and v.Humanoid.Health ~= 0 and v.HumanoidRootPart.Position.X > -500 and v.data.stats.level.Value >= minlvl and v.data.stats.level.Value <= maxlvl then
            table.insert(Target,{v.HumanoidRootPart,(HRP.Position-v.HumanoidRootPart.Position).magnitude,v})
        end
    end
    table.sort(Target,
        function(a,b)
        return a[2]<b[2]
    end)
    return Target
end
function kill()
    if plr.Character.Humanoid.Health < 1 or ScriptOn == false then task.wait(5) return end

    if not plr.Character:FindFirstChild("Weapon") then
        repeat
            VIM:SendKeyEvent(true, "E", false, game)
            VIM:SendKeyEvent(false, "E", false, game)
            task.wait(1)
        until plr.Character:FindFirstChild("Weapon") or ScriptOn == false
    end

    local Target = FoundTarget()
    
    repeat
        tweenService, tweenInfo = game:GetService("TweenService"), TweenInfo.new(((plr.Character.HumanoidRootPart.Position - Target[1][3]:FindFirstChild("HumanoidRootPart").Position).magnitude/Speed), Enum.EasingStyle.Linear)
        tween = tweenService:Create(plr.Character.HumanoidRootPart, tweenInfo, {CFrame = Target[1][3].HumanoidRootPart.CFrame + (Target[1][3].HumanoidRootPart.CFrame.lookVector * -distance)})
        tween:Play()
        VIM:SendKeyEvent(true, "Space", false, game)
        if (plr.Character.HumanoidRootPart.Position - Target[1][3]:FindFirstChild("HumanoidRootPart").Position).magnitude > (distance+5) then
            tween.Completed:Wait()
        else
            task.wait()
        end
        VirtualUser:ClickButton1(Vector2.new())
        if z then
            VIM:SendKeyEvent(true, "Z", false, game)
            VIM:SendKeyEvent(false, "Z", false, game)
        end
        if x then
            VIM:SendKeyEvent(true, "X", false, game)
            VIM:SendKeyEvent(false, "X", false, game)
        end
        if c then
            VIM:SendKeyEvent(true, "C", false, game)
            VIM:SendKeyEvent(false, "C", false, game)
        end
    until Target[1][3].Humanoid.Health < 1 or plr.Character.Humanoid.Health < 1 or ScriptOn == false or not plr.Character:FindFirstChild("Weapon")
    VIM:SendKeyEvent(false, "Space", false, game)
end
coroutine.wrap(function()
    while task.wait() do
        if ScriptOn == true then
            pcall(kill)
        end
        if eat then
            pcall(function()
                for _,v in pairs(game:GetService("Workspace").Live:GetChildren()) do
                    if v:FindFirstChild("ClickDetector") then
                        if plr.Character.Humanoid.Health < 1 or eat == false then task.wait(5) return end

                        tweenService, tweenInfo = game:GetService("TweenService"), TweenInfo.new(((plr.Character.HumanoidRootPart.Position - v:FindFirstChild("HumanoidRootPart").Position).magnitude/Speed), Enum.EasingStyle.Linear)
                        tween = tweenService:Create(plr.Character.HumanoidRootPart, tweenInfo, {CFrame = v.HumanoidRootPart.CFrame})
                        tween:Play()
                        tween.Completed:Wait()
                        task.wait(0.5)
                        fireclickdetector(v.ClickDetector)
                        task.wait(0.5)
                    end
                end
            end)
        end
    end
end)()
coroutine.wrap(function()
    task.wait(1200)
    plr:FindFirstChild(npc51)
end)()
